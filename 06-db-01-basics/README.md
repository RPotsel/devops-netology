# 6.1. Типы и структура СУБД

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

__Ответ:__

- Для хранения электронных чеков в json виде хорошо подходит документо-ориентированная СУБД, т.к. хранение в формате json классический формат данных в NoSQL СУБД;
- Данные для хранения складов и дорог между ними можно организовать с помощью нод и ребер в графо-ориентированной СУБД;
- Генеалогическое дерево хорошо вписывается в реляционную СУБД, т.к. хорошо структурируется в табличную форму с предопределенной схемой данных;
- Для хранения кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации, подходит в СУБД ключ-значение, требование к ограничению времени жизни соответствует Memcached;
- Отношения клиент-покупка для интернет-магазина лучше описываются требованиями к реляционным БД, когда целостность данных считается ключевой характеристикой и программное обеспечение соответствовало требованиям ACID.

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если (каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

__Ответ:__

- PA - т.к. задержка синхронизации данных на всех узлах не позволяет гарантировать консистентность данных при разделении системы. PA/EL - высокая доступность (A) при разделении (P) системы иначе (E) высокая скорость ответа (L). 
- РА - при разделении системы данные доступны, но не консистентны. Подходит PA/EL.
- СР - данные недоступны, но система консистентна. PC/EC -  системы, которые стараются максимально приблизиться к парадигме ACID с большой долей вероятности будут жертвовать доступностью (A) в угоду консистентности (С).

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

__Ответ:__

Требования ACID ориентированы на целостность данных, BASE - на их высокую доступность. В теории, BASE не предоставляет основные принципы ACID: гарантии атомарности, хотя некоторые NoSQL базы данных предлагают отдельную API для атомарных операций; гарантии изоляции, это может означать, что БД запишет данные не в том порядке, в котором они поступили на запись. Базы данных BASE почти полностью отказываются от требований согласованности модели ACID. Разработка систем в которых соблюдаются сочетаются требования BASE и ACID ложатся на плечи разработчиков этих систем и баланс принципов может серьезно усложнить систему и её развитие.

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?

__Ответ:__

Согласно статье речь идёт о Redis, основными минусами при выборе которой являются:

- "Из коробки" не имеет механизма консенсуса;
- отсутствие поддержки языка SQL ограничивают методы поиска по данным;
- т.к. все данные хранятся в оперативной памяти, при незапланированной остановке сервера данные будут потеряны если не настроена персистентность.
